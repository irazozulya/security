using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SecurityLabs
{
	public static class Task1
	{
		private static readonly List<char> _lowercaseLetters = new List<char> { 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z' };

		private const decimal _lowercasePercent = (decimal)0.6;

		private const decimal _eLetterFrequency = (decimal)0.1;

		private const decimal _tLetterFrequency = (decimal)0.08;

		public static void Exec()
		{
			/*var input = "01010110001100100101011001110011011000100100001101110111011001110101100101010111001101010110101101001001010001110011010101110110011001000111100101000010001101010110001000110011010101010110011101100011001100100101011001101100010010010100100001010010011011110101100101011000010100010110011101100001010110000101010001101001011001110100101001101100011110100100100101000111010001100110100101100011001100100011100101110011011001000101100001010010011011000110001001001000011010110110011101100011010001110011100101110000011000100110111001010010011100110101101001011000010011100111101001001001010010000101001001110110010010010100100001010010011110010110010101010011010000100011000001100010011110010100001001110000011000100110111001011010011011000110001001101110010100010110011101100101010101110011100100110001011000110110100101000010011101100110010000110010001101000110011101000011011010010100101001101010011000110110111001101100011101110110010001000111001110000110100101001001010010000110010001110000011001000100011101100111011001110101101001011000011010000111011101011010010101110100111000110000010110010101100001010010011100000110001000110010001101010111101001001001010010000101001001101111010110010101100001010001011001110110000101010111010110010110011101100011001100100011100101110100010110100101011100111001011101010101101001010011010000100110101101100010001100100101011001111010011000100110100101100100001100000100100101000111011101000111010101100010001100110110001101100111011001000100011101101000011011000100100101000111010001100111001101011010001100100011100101111001011000010101100001010010011011110110001001010011010000010110111101011010010110000101101001101100011000100110100101000010011010010110000101010111001101010110100001100011011011100110101101100111010110010110110101000110011110100101101001010100010110010011000001001100010000110100001000110011011000010100011101101100011010100110000101000011010000100111000001100011011110010100001001110111011000110110110101010110001100000110010001001000011010110110011101100011001100110101001000110001011000110100011101101100011010110100101101010011010000100111000001100100010011110100101101000001011011010101100001001101011001110110000101010111001100010111011101100010001100110100111001111010011000010101011101001010011100110101101001010011010000100110110101100010001100110100100101100111011000010100011101101100011101000100100101001000010100100111011001001001010001110101001001101100010110010011001001101100011101110110000101000111010101100111100101001100011010010100001001011010011000100011001101010101011011100110001101101101010101010110011101100011011011010101011001101000010110100100011101101100011101010101101001111001010000100011000001100001010001110110110001111010010010010100011100110101011101100110010001111001010000100111000001100010011010010100001001110111011000100100011101000110011100000110001001101001010000100011000001011010010110000110100000110000010010010100100001001110011101100100100101001000010100100110111101011001010110000101000101100111010110010101100001001010011011100110010001010111001100010110110001100010011011100101000101100111010110010011001001111000011011000101100101011000010010100111001101100101010100110100001001101101010110010101011101111000011100110110001101111001010000100111101001100001010001110011100101111001011001000100001100110100010010110100001101101011001101010111011001100100011110010100001000110000011000100111100101000010001100000110000101000111010101010110011101011001010101110100111000110000011001000101011101000110011100110100100101001000010100100110100001100011001100100111010001111010010011000110100101000010010000100110001001000111011101110110011101100010001100100101100101100111011001000100011101101000011011000110001001010011010000100110100001100011011011010101010101100111010110100011001101001010011010000101101001000111010101100110101101001001010001110100101001101000011000110011001001010110011010110100100101000111001110010111010101001001010010000101001001101111010110100101001101000010011010100110001000110010010100100110110001001001010010000110110001110110011001000101001101000010001100110110001101101101011011000011000001011010010100110111011101100111011000110011001000111000011001110110001001101101001110000110011101100011010001110011100101110000011000100110111001010001011001110110000101010111001101000110011101100011001100110101001001101100010110010101011101111000011100000110001001101101011000110110011101011010010001110101011001101010011000010101100001000010011011110101101001011000010010100110110001011010010000110100001000110000010110100101100001101000001100000100100101000111010110100111100101100010001100100011000001100111011001010101011100111001001100010110001101101001010000100110101001100010010001110100011001111010011000110011001000110001011010000110010001000111010101100111101001001100011001110111000001011000011000110110110101101100001100000101101001010011010000100110100001001001010010000100001001110000010110100101011101001110011011000100100101000111001110010110110101001001010010000100111001110110010110100110111001010010001100110101100101011000010010100110110001001001010010000101001001110110010010010100011101000110001100000110010001000111010001100110101001100001011110010100001001101000010010010100100001001110011100000110001001101101011001000111001101011010010100110011000101101001011001010101100001010010011011000100100101000110011010000101000001010101011010010100001001101010011000010101100001000010011011110101101001011000010010010110011101100100001100100110100001110000010110010011001001100111011001110110000101011000010011010110011101100100010001110110100001101100010010010100100001001110011010000110001001010111010101010110011101011001010110000100110101100111010100010011001001000110011011000110001100110010010001100111100101001001010001110100101000110001011001000100001101000010001100110110000101011000010100100110111101001001010010000110100001110110011000110110100101000010011101100110001101000011001101000100101101001110011110100110101100110001010011110100010001010001011101110100110101010100011000110011000001001101011110100101000100110001010011100100011101010101011110000100111001111010010101010011001001001101010101000110001100110000010011100101010001010101011110010100111001000100011000110011000101001101011010100101010100110010010011100100010001001101001100010101101001010100010101010011010101001110010101000100000101111000010110010101010001010110011010100100111001010100010010010011000001011010010101000100010100110011010011100110110101011001001100110100111101000100010110010011000101001101010101000110001100110001010011100100010001010110011011000100111001000100011000110011000101011010011010100101010101111001010011100100010001010101011110000100111101010100010001010011001101001110011110100100100101111000010011110101010001010101011101110100110101010100011010110111100001001110011110100101011001101100010011100100010001001101011110000100111001111010010100010011000001001110010101110101100100110001010011110100010001010001011110010100111001010111010010010011000101001101011110100100010100110011010011100100010001001101001100010100111001101010010101100110101001001110010101000100100101111000010011100111101001010101001100100100110101010100011000110011000001001110010001000101000101111010010011100100010001010101001100010101101001010100010101010011010101001110010101000100000101111000010011100011001001010001001100010101100101101010011001000110100001011001011010100101011001101101010011100101010001001001001100010101100101101010010101100110100101001110010101000110011101111000010011100111101001010001011101110100111001010100011001110011000001001110010101000101011001101001010011100101010001001110011010110100111001010111010010010011001101011001010101110100010101111000010011100111101001010101001100100100111001010100011010110011000101001101011110100100011001101001010011010101010001100011001100010100110101000100010101100110110001001110010001000100010100110001010011010110101001010101001101010100110101010100011000110011000001001101011110100101011001101101010011100101010001001001011110000100111001111010010101100110101001001110010101000100100100110000010110100101010001000101001100110100111001010111010101010011000001001110010001000100010100110011010110100100010001010110011010010100111000110010010001100110100101001110010101110100110100110001010011010110101001010010011011000101101001000100010101100110100101001110001100100100011001101000010011010101011101001001011110000100111001111010010100100110110101001110010101000110011100110000010011100101010001000101001100110100111001000100010011010011000101011010011010100101010101111001010011010101010001100011001100010100110101010100010101100110110001001110010001000101010100110000010011100100010001010001011110100100110101010100011000110011000101011001011010100101010101111001010011100100010001001101001100000100110101111010010101010111100101001110010001000101010101111000010011100011001001010001001100010101100101101010011001000110100001011001011010100101011001101101010110100100010001010110011010010100111000110010010001100110100001001101010101000110001100110000010011010100010001010110011011000100111001000100010011010011000101011010011010100100010100110011010110100100010001010110011010010100111000110010010001100110100101001110010101110100111001101011010011100101011101001001001100110101100101010111010001010111100001011001011010100100010100110011010011100100010001001101001100010101101001101010010101010111100101001110010101000110101101111000010011100111101001010010011011010100111001010100011001110011000001001110010101000100010100110011010110100100010001010110011010010100111000110010010001100110100101001110010101000100101001101011010011100101011101001001001100110101100101010111010001010111100001001110011110100101000101110111010011100101011101010101001100000100110101111010010101100110110101001101010101000110010001101011010011100101011101001001001100110101100101010111010010010011000101001101011011010101000100110001010110010110101001100100011010000101100101010100010001100110100101001101010101000110001100110000010011010111101001010110011011010100111001010100010010010011000101001111010101000100010100110011010110100100010001010110011010010100111000110010010001100110100101001110010101110100101001101011010011100101011101001001001100110101100101010111010001010111100001001110011110100101000101110111010011100101011101010101001100000100110101111010010101100110110101001101010101000110010001101011010011100101011101001001001100110101100101010111010010010011000001011010010101110101000100110001010110010110101001100100011010000101100101010100010001100110100101001101010101000110001100110001010011100110101001010101001101010100111001010100010011010111100001001110011110100101000101111010010011100101011101011001001100010100110101101010010101010011010101001101010101000110001100110000010110100110101001010101001101000100111001000100010101010111100001001110011110100101010100110101010011100101010001001001001100000101101001101010010100010111101001001101010101000110001100110001010011100100010001010110011011010100111001010100010110010011000001001110010101000100010100110011010110100100010001010110011010010100111000110010010001100110100101001110010101110100101001101011010011100101011101001001001100110101100101010111010001010111100001001110011110100101000101110111010011100101011101010101001100000100110101111010010101100110110101001101010101000110010001101011010011100101011101001001001100110101100101010111010010010011000101011001001100100101000100110001010110010110101001100100011010000101100101010100010001010011001101001110010101000101100100110001010011010100010001010101001100100100111001010111010101010011000101001111010101000100011001101001010011010101010001100011001100000100110101111010010101100110110101001110010101000100100100110001010011110101010001000101001100110101101001000100010101100110100101001110001100100100011001101001010011100101010001101000011010110100111001010111010010010011001101011001010101110100010101111000010011100111101001010001011101110100111001010111010101010011000001001101011110100101011001101101010011010101010001100100011010110100111001010111010010010011001101011001010101110100100100110001010011010110110101010001001100010101100101101010011001000110100001011001010101000100010100110011010011100101010001011001001100010100111101010100010101010111101001001101010101000110001100110000010011100100010001010101001101000100110101010100011000110011000101001111010001000101010100110101010011010101010001101011011110000100111001111010010110100110110001001110010101000110011100110000010011010110101001000101001100110100111001010111010001010011000101001110011010100101001001101100010011010101010001100011001100000100110101101010010100010011000001001110010101000100100101111000010011100111101001010101001100100100111001010100011010110111100001001110011110100101011001101100010011100101010001101011001100010100110101111010010101010111100101001110010001110101100101111000010011100111101001010101001101000100111001010100010001010111100001001110011110100101010100110000010011100101010001100111001100010101101001010100010101010011010101001110010101000101000100110001010110100101010001010101011110100100111001010100010010010011000101001111010101000101010100110000010011100101010001001001011110000101100101101010010001010011001101001110001100100101100100110001010011100110101001010110011010000100111001010111010001010011000101011010010101000101010100110101010011100101010001000001011110000100111001111010010101010111101001001110010101110101010100110000010011100100010001010001011110100100111001010100010110010011000101001111010101000101010100110000010011100101010001001001011110000101100101101010010001010011001101001110001100100100110100110001010011100110101001010001001100000100111001010111010101010011000001001110010001000101011001101010010011100101011101010101011110000100111001111010010101010111100101001110010001110101100100110001010011100110101001010110011010000100111001010111010101010011000101001111010101000101010100110010010011100100010001001101001100010101101001010100010101010011010001001110010101000110101101111000010110010110101001000101001100110100111001000100010100010011000001001101011110100101010100110010010011100100010001001101001100010101101001010100010100010011000001001110010001000100110100110001010110100101010001010101001100000100111001010100010110010011000101011001011010100100010100110011010011100100010001001101001100010100110101101010010100010011000001001110010001000100110100110000010011100100010001000101001100110100111001010100011001110011000001001110010101000100010100110011010011100100010001000001001100010101101001101010010101010011001001001110010001000100110100110001010011010110101001010001011110000100111001010100010010010011000001001110010101000100010100110011010011100101011101000101001100010100110101101010010100010111101001001110010101110101100100110001010011110100010001010101011110100100110101010100011000110011000001011010010101000101010100110100010011100100010001001001011110000100111001111010010101010111100001001110010101000100100100110001010011010110101001010110011010010100110101010100011000110011000001001101010001000101010100110100010011100100010001001001001100010101100101101010010101010111101001001101010101000110001100110000010011100100010001010110011011010100111001010100011001110011000001001101010001000100010100110011010011100100010001001101001100010101101001101010010101010111100101001101010101000110001100110001010011100101010001010101011110010100111001000100010100010011000001001101011110100100010100110011010011100100010001010101001100010100110101101010010100010011000001001110010001000100100100110001010110010110101001010001011110100100110101010100011010110100101101010010011110100100001001001010010100100110101100111001010001110101011001101011001100010100110101010101011010110100011001010001010100110101010001000110010100100101001101101101010010100100011001010101010101010101001001101001010100100110101101010110010110100101010000110000010110100100011001010101010001010111000000110100010100010101011101011010010010100100110101010100010000100100101101011001011010110101011001001110010100100110101101101100010101100101000101010101010001100100110001010101011010110100011001101101010101000011000101011010010010100101101001101011001110010100011101100001001100010110110001010000010101100101011001000110010001110101001101010100010001010011000101010100010101010111011101111000011000010011001001001110010010110101001001101100010101100110110001010111010101110110100001000010010011100100010101101100001101000101000101010111010101100100110001010110011011000100011001100001010101000100010001000110010101110101010001010101001110010100011101011010001100000111000001101001010100100110101100110001010001010101001101010110010101100100001001010001010101010111010001010110010110100011000001011010010100000101001001010111011110000100111001010011010101000100011001100001010101000101010100111001010001110101101000110000010110100101000101100101010001010100011001000101010100110101011101111000010101110101010001010101001110000111100001010110011010110011000101010000010011010101011101110100010000100101001101010101010010100100001001010111011011000100000101111000010101100110101100110001010010100100110101010100010100100100001001010100011011000100101001000010010101110110110001000010010001100101000101010101011100000101000101100010010001010011000101001111010101010100010001000110010101110101010001010101011011000100011101010110010101100110110001010000010100100110110001010110011011000101010101001000011010000011010001010100010101100100000101111000010011110101010100110001010100000101001001101101011001000100101101011001011010110101101001111010010100110110101100110101010101100101010001010111010011100100110101010110011010110011000101001011010110010110101101011010011100100101101001101101010010100100011101001111010001010100111001001010010100100101011101111000010011100101101001101101011001000110000101010100011011010100101001001000010101010101010101010010011010010101001001101101010011100100101101010100001100000100101001000010010101110101010101110000010001110110000100110010010110100110100101010010011010100110100001000100010100110011000101001010010000100101101001010101011100000101011101011001001100000101011001010000010100010110101101000110010011110101010000110001010101100101001001010010010001010110110001010111010100100101011001101100010010110101011001101011001100010100111101010011010101010101101000110011010101100110110101001010010001100110000100110000010100100101000001010101011010110100011001101001010100110110110001011010001100110101000101010111010010100100011001010001010101110101011001001010010011010101010101101100010011110101010001000111011110000011001101010110011011010100101001000111010011100100010101110000010011000101011001101100010010100100111001010100001100000101100100110101010101000101010100111001010101100101010001010101011100000110100101010010010101010011000101000101010100110101011001011010010101110101010001010110010000010111100001001111010001110101011001010000010100010110101101000110010001010101001100110010011010000100001001010100010001010111010001010111010011100100010101110000010100000101001001101101011101000101000101011001011010110101101001000110010100010101010101110011011110000100111101000111010101100100101101010110010101100100011001000110010100110101011001001010010000110101001001010101001110000111100001011010001100000101101001001101010011010101011101101000010011100101010001111010010001010011010001011010010101010110111101111000010101100101010101101100011010010101001001010110010001100100011001010011001100010100101001000010010101000011000001110100010101100101010001010110011011000110100101010010011011100110010001001111010101010100010001000010010100110101010001010101001101010101011101010110010101010011010101010001011000010100011101111000010000100101100101101011010101100100111001010010011010110110110001010110010101100101010101000110010011010101011001010110010001100100101101010011001100000100101001000010010101000110101101101100011100110100111001000101011100000100110101010110011011100110010001000111010100110101011101111000011010110101010001010101011010110111011101010011011010110011000101001100010011010100010101101100010011110101001100110000010110100111001001010011011010110110110001110010010101010110101100110001010011000101001001101100010101100110110101010100010001000100011001010110010100010011000000111001010000110100111001010101001100010100100101001101010101100101011001101100010100110110110001011001001101000101011101101100010000010111100001100100001100010101101001011010010100010110101101000110011010010101010101000111011110000111001001010111010101010111010001010011010100010101010101011010010100000101000101101011010001100110110001010011011011000101101001101010010100100101010100111001010000110101000101010101010011100100101001001101010001110101001001000010010110010110101101010110011100100101001001000101001110010101001101010001010101110100101001001011010101100110111001100100010000100101100101101011010110010011000001010011011010110111010001010111010101010110101100110001010010110101011001010110010010100100111001010100001100000101100100110101010101000101010101110100010001110101011001010110010000100100101101010110010101010100011001000110010100110011000101010110010010110101010001010101001110010100011101011010001100000111000001101001010100100110101001010010010010110101010001101011010101100101001101010100010101010110101101111000010011100100010101110000011010010101001001101011010101100110110101011001011010110101011001101010010100110110101101101100010001110110010101000101010011100110100101010011010001010110110001001011010101000100011001010110010010110101010001010101011100000101011101001110010101010011000101001010010101100110110101110100010001000101001100110000010010100011010001010100010101010011100101000111010110100011000001110000010100010110001001000110010110100100110101010101010010000110100001000010010100010011000001101100001101000101000101010111010110100101000101010010011010110101011001010001010100110011000101010110010011110101000100110010010010100100010101100010001100000101011001010000010100100101011001000110011010100101010101001000011001000111011101010010010001100110101101111000010101010101010101010010010011010100110101000101001101010100010001010011011110100100010100110100010100100100010101110011011110000110010000110000011100000101101001100010010001010011000101000101010100110101011001001001001101000101001101010101011010110111100001010100010101100111000001001010010101100110110001010110010001000101010000110000010010010011010001010011010101100110110000110011010100100101011101110100010001110101010101010111010011100111011001010011010101010100100101111000010101110110101101110000010101100101010101010100010001100100010001010001010101010011000100110010010100100101010001000110011010100101001101000101001110010101011101010110010110000101011001010000011000010011000101101100001100010101000100110010011101000100001001001110010001110101011001001001010101000101010101110000010011010100110100110010010011010011010001010011011011000110010001001011010110100110110101011010010010010101001101010111010110100100010101010110001100000110110001000010010100100011000001010110010000100100111101010110011010110111100001010110010101010110110001001011010101100101011001001010010101010101010000110001010101100100111001011001001100100100111001010110010101000101010101010110010011010101011001010101011011000100011101010011010101110111100001101010010100000101000101110000010001100101001001101011010110100101000101010101010101010111100001000110010100110011000101011010010101010101011001101100010000100100010001010101010001100110110001000111010101000100010100110001010101110101001101000110010001100100110101010110010101010101011001011000010100010011000000110101010101110101011000110000010110100101101001010010001100000110100001011010010101100100010101001110010001100101011001000101011010000101001001010010010101010111010001001101010101010100011001011010010011100101010100110000010001100100110001010101001100010100001001010111010101010100010101000110010100010101011001101100011011000101100001010100010101100101101001001001010101010101010101111000010101100101010100110001010000100101001001010100010001100110110001011000010101000100010101000110010101000101010001000101010110100101011101010110001100010100001001010010010101000100010100110001010101110101001101000110010001100100110101010110010101100100001001001101010101010110110001000010010101000101010101010101011110000101011001010100010001100100011001000110010101010011000101000010010000110101010001000110011001000101000101010001001100010100111001010111010101010110110001011010010110000101001001101011011110000100100101010100010001100110010001000111010101000100011001100100010100010101011001010101010101100101100001010010011011000110110001010000010101100100010101001110010011100101010101010110011011000101010001010100010001100110010001010000010101110101011001100100010110100101001001010110010100100100100101010101010101010101011001001100010101000100011001000010010101110101010001010110010011100100001001010011001100010100111001010001010101100110110001000010010000100101010101000110010110100101101001010110001100000110100001000110010101010100011001000010010011010101011001010110011001000101010001010010001100010110110001010110010101000100010101010110010011100101010101010110010100100100110101010101010001100100001001001101010101100101010101100100010101100101011101010101001110010100110101010110001100000101001001010101010101100110110001001110010100100101001001010110010100100100100101010101010101010101011001001100010101000100011001000010010101110101010101000110010110100101010001010100010101100101001001001101010100100101011001010110010100010101010101010101010101100101000101010001001100010110110001000010010101000101010101010110010110000101011000110001011011000101010101010111010101100110010001000101010101000100011001010110010101100101010001000110010100100100010001010111010101100110010001010001010101010101010101111000010101000101001001010101001110010100110101010101001100010101101001010000010100110100011001010010010011010101011001010110011011000100001001010101010001100101101001011000010101000100011001101100010010000101001001000101010001100100110101010101001100010100111001010111010101100011000001010010010100010101010101010101011110000100111101010100010001010100111001001100010100010011000001111000010100110101010101010101010101100100001001010101001100010100001001010111010100110101010101111000010101000101010001000101010101100101011001010100010101100100011001000011010101010101011001011010010011100101010101010101010011100101101001010001010101010110100001010110010101110101010101110100010001100101001100110001010100100100010001010001010101100100111001001101010100100110110001000010010110100101001001101011011110000100111001010110011010110110100001010010010101000100011001010110010100010101010101010101011110000100100101010110010101010111100001001010010101100110110001101100010000100101010100110000011010000100011001010110010101010101011001000101010101100101010101010110010010010101010101010101010010100101011101010110010001100101001001010001010101010101010101111000010101110101011000110000010110100100110101010101011011000110110001001000010101000101011001101100010101110101011000110000001100010101011101010010011010110111100001011000010101000101010101111000010101000101010101000110010110100101010101010110010001010100101001011010010101100101010100110101010001100101010100110000010101100101010001010001010101010101001001000101010101000100011001001110010100010101011001101100011011000101100001010001001100010110110001000010010101000101010101010110010110000101010101000110010101100100010001010101010001100110110001000111010101100110101101101100010101110101001001101011011110000101000101010101010101010111100001010000010101000100011001001110010101000101001001010101010100100100110101010110011011000110010001001001010100100101011001010110010100010101010100110000011101000100010001010101010001100100011001001101010101100011000001000110010100000101001100110000011110000101011001010111010101010110010001001110010101010101010101010110010101100101001001010101001100010101000101010100010001100101011001010100010101100110110001100100010001100101010001101011011110000100010001010010010101100110010001000111010100100101010101101000010010010101011001000101010011100100100001010110010101010111100001011001010100010101010101111000010110000101010001010101010011100100011001010110001100000101011001010101010100010011000101001110010101110101010100110001010000100101101001010100010001010101011001001110010101010101011001101100010010000101010101000110010001100100110101010100001100000011000101000110010101100011000001001110010110100101000101010101011001000101011101010110001100000101101001000110010100010110101101010110010001000101010101000110011011000100001001010101001100000111100001010010010101100110101101010010010100100101010001000110010101100101101001010110010101010101101001001101010101100101010101100100010101100101010001000110011010000100001001010100010001100110010001001110010100010011000101001110010100010101001001010110010000100101011101010101001100010100001001010111010101000101011001001110010000110101011001101100010000100101001001010101010001100100011001010111010101010011000101000010010001000101001101000101011110000101101001010010001100000011000101010111010100110100011001000110010011010101011001010110010000100101001001010100010001100110010001001101010101010110110001000010010100000101001001010101010100100101011101010100010101010101011001010101010100010110110001101100010101100101001001101011010010100101011101010110010001100101001001010001010100100101010100110101010011010101010101000110011011000101000101010101010101010111100001011000010101000100011001001010010100010101011001000101010101100100110001010100010001100110010001100001010101110101010101001110010011000101011001101100010000100101010101010001001100010100111001010101010100100101011001001110010100100101010101000101010010100101101001010100010101010101011001001001010101100110110001000010010001100101011001000101010011100100111001010010010101010110100001010111010101010100010101010110010101010101011101101011001100010100011001010011010001100101101001010001010100100101011001010010010011000101011001000101001100010100011001010011010001100101101001010001010100100101011001010010010001000101010001010101010101100100100101010110011011000100001001000110010101100100011001010001010010110101011001010101001100010101011001010101010001010111100001011010010101010110110001101000010100000101011101010110010010100100010001010011001100010101001001011010010101110101011001000010010001010101011101010110011100000101010101010100001100010101011001011010010100100100011001110000010010010101011101010101011100000101101001010110010101010011010101010101010101000011000000110001010110100101011001000101001110010100110101010110010001010111010001000010010101000011000001101000010100000101001100110001011100000100010001010100010101010111010001000010010101100110110001110000010001010101011101010101010010100101001101010100001100010100101001010001010101100100010101101000010100100101010001000110010011100100011001010101011011000101011001010000010100100101011001001010010011100101001100110001011100000100100001010101010101010111000001010000010100110101010101010010010010110101011001010101010100100100111101010010010001100111000001000010010101100100011001010110010101110101010000110001010100100101010101010100010001010011000101010010010100010110101100111001010110000101010001101011001100010100011001010101011011000100011001010101010100100100011001010010010101100101001001101011011101000110000101010001001100000011000101010101010100010101011001110000010011100101001001010101001110010100101101010011011010110111000001010000010101110100010100110001010001100101010101101011011101000100101101010011010001010100011001000100010101000101011001010010010000100101011101101011010001100101010101010011010101100111000001010000010100100101011001000010010100010101001101101011011101000100101001010011011010110111000001001111010101000011000001001110010001110101001001010110010000100100110101010010011010110100101001010110010101000110110001000110010010010101001101000110010000100101000101010011001100010110110001011010010100110011000101000110010000100101011101101011011101000101010101010100001100010101001001001010010100110011000101110000010011110101011101000110010000100100100001010101010101100111000001010010010100010101011001110000010011000101011001000101001110010101010101010011010101100111000001011010010101000110101101101100010101100101001101010110010011100110000101010011010101010100011001000110010101000100010100110001010011000101010100110000011100000101000001010111010101100101011001011010010101110101011001010010010010010101010001101011010101100100101001010010010101010011100101000110010101010011000101010110010011010101010000110001011010000100110101010110010101010101011001011010010100100011000001001010010001100101011001010101011001000100101101010100010001010110100001000010010100110110110001010010010010000101001000110000001110010100011001010100001100010100111001001110010100110110101101101000010011110101001001101011011100000100001001010100010001010101101001000011010101000011000001101000010100000101001100110000010001100100100001010101010001100101001001001010010100110100010101110100010011110101010001010101011101000101010101010100001100010101011001010110010101100101010100110001010101100101010101010110010101100100010101010001010101100101001001010110010100100101010101101100010100110101000101101011011101000101101001010110010101100100011001010101010101100011000001110100010010110101001100110001011100000100111101010100010001010101001001010011010101110110101101001010010011010101011001000101011100000100101101010011011010110110110001000101010100110110110001101100010101000101011001010101011110000100101101010001010101100100101001001100010100110100010101110100010101100101001100110000010010100100101001010101001100000100101001001101010101100100010100111001010010110101010101101011010001100101010101010011010101010011100101001010010101100100010101101000010110100101011001010101011110000100011101010001011010110110110001010101010101000011000101011010010010010101010101101100011100000100101001010001010101100110100001000111010100100100011001001010010011110101001101010101001110010101001101010100010001100111000001000110010101110101011001010110010101100101001101101011011001000100011001010001011010110101011001011010010101000100010100110101010011100101011101010101010011100110000101010010010001010110110001010101010100110011000101010110010110010101010100110000011100000100011001010011011010110100111001000111010100100101011001010110010010000101001101101011011100000101000001010110010001100100011001000110010101110110101100110101010100000101010101101100010000100100111101010110010101010101001001010001010101000110110001000110010010100101000101010110011011000101000101010010010101010101001001011010010101010100010101010010010110100101011001000101011100000100001001010011010101010110010001001011010101110101011001010110011000010101000101101011011110000101010101010011011010110111000001011010010101110101010100110101010101010101010001010110010011100100011001010011011011000110110001000111010101000110101101110100010010010101010000110001010100100100101101010001010101100100101001001111010101000100010101101000010010010101010101101100011010000100010101010110010101100100001001100001010100110101010101000110010011010101011101101011010101100100010101010110010101100110110001000010010101000011000101001110010000110101000101101011011011000101010101010011001100000111010001011010010101000100011001101000010011000101011101101011001101010101001001010010010101100110110001001100010100110011000101110000010101010101010000110000011101000100100101010110001100000100111001010000010101000100010101110100010101100101010101101100010100100101100101010101001100000111010001001100010100010101010101100100011000010101001001010110010000100100110101010101001100010110110001001001010101100100010100110001010011000101010101101011011101000100101101010011010101010110110001010010010101110110101101010010010101010101010001101011011010000100010101010111010101100110100001001110010100100101010101101100010100110101010001010110010010100101000001010010001100000111000001011010010101100101010100110001010010010101010001010101010100100100111101010111011010110110110001010000010101100100011001000110010001100101001100110001010101100101001101010110010001100110100001010100010100110011000001110100010000100101001000110001011100000100011001010101010001010111100001010100010101110101010101101000010101010101010001010101011101000101001101010011001100000111000001001010010100110101011001000110011000010101001001000110010100100100111101010101011010110011100101000010010101100101011001101100010011010101010000110001010100100100101001010100010101010101001001010010010100110110110001101100010100100101011101000110011100000100010101010101010001100101011001001110010101110101010100110001010110100101010101000110011011000101001101010101010101010011010101011010010100100110101100110101010101100101011101010110010101100100101101010011011010110101011001000011010100100101010100111001010011100101001001000101001101010100101001010111010101100101011001010000010100110100011001101100010110100101011101010101011100000100100101010001010101010011100101010010010100100100011001001010010011000101001100110001011100000101001101010101011010110111000001000110010101010100010101001110010001110101010001101100010010100100110001010011011011000101011001001001010101010011000001110000010100000101001101010110010010100101001001010111010101010101001001100001010100010110101101110100011000010101011001010110010010100100110001010010010001010011010101001111010100100101010100111001010110100101000101101100010100100100110001010111010101100100001001000110010100110110101101001110010011100101001100110000001110010100001001010011011010110011100101010011010100110011000101010010010011000101001101101011011110000100011101010011010101010011100101010010010100110100011001101100010100010101010001101011010010100101010101010001010101100101101001100001010100100101011001010110010100000101000101101100010100100100110001010011001100000100101001010000010101100011000101001110010000110101001100110000001110010101010001010011001100010111000001010110010101000011000101110000010010100101001101000110010001100101010001010100010001010110110001001011010100110110101100110001010101000101011001010110010010100100100101010111010101100111000001001011010100110110110001110000010101100101001100110000001110010100001001010111010101010111010001001111010100110101011001101100010011000101001100110001011100000100111101010011010001010011000101001010010101100100010101001010010101010101010101101011011101000100001101010100001100010100001001001111010101100101011001101100010100010101010001101100010100100101010101010101010001010011100101001100010100110011000101110000010011110101001100110000011101000110000101010100011010110111100001001100010101110110101101001110010001110101010001101100011011000101010101010011001100000111010001010010010101000110110001010110010110100101001000110001010001100100101101010011001100010111000001001111010101110100011001101100010001010101010001101011011100000101101001010111010101010011000101000110010101110110110001001010010010110101001101101011011100000101000001010111010001010011000101000110010101010110101101110100010010110101011001101011001110010101010001010011011010110110110001010000010101010011000001101100010100100101000101010101011001000101010101010111011011000110110001001111010101110110101101101100010100000101011101010110010011100100111001010100001100000110100001010010010100100100011001010010010010010101010001010101010101100100010101010110001100000111000001001100010100110101011001010110010011010101010001101011001110010101010101010001011010110100111001000010010101000100010101011010010000110101001101101011001101010101010101010100001100000110010001010100010100110110101101110100011000010101010001101011010101100100011001010111010101100110110001001100010101100101010101101100010110010101010001000101010101100101011001010100011010110111100001001111010100110100010100110101010011100101011101010110010101100101000001010100010101100110010001001001010100110100010100111001010100000101010101010101001101010101011001010111010101010110010001010010010100110110101101110100011000010101010001000110011100000100101101010111011010110111100001010000010101000100010101000110010101010101010100110000010101100100100101010101010101010111010001010101010100010101011001101100010100010101011101010110010010100110000101010011011011000110110001000101010101000110110001000110010001010101011001000101011010000100001101010110010001010111010001011010010100110011000101101100010001110101001000110000011100000101001101010101011011000101011001000111010100100101011001100100010011110101011001000101011010000100001001010111010001010101101001000010010100110100010101101000010100000101001001000110010101100101000101010111011010110011000101011001010101100101010100110001010011000101011101000110010101100100011101010010010101010011100101010101010100110101010100110001010101100101010001101100010001100100101001010011010001010110010001010001010100010101010101000110010001000101001001101011011101000100001001010110010001010110110001001100010100110101011001110000010000110101011001000101001110010101010101010011010101010111010001100001010101000110101101110100010011000101011101101011001101010100110101010100001100010100101001010110010100110011000000110001010011010101010001000101010110100100001101010110010101100101011001010010010100110011000101110000010011110101010001000101010101100101000001010011010001010110110001000110010101000011000001101000010001100101001001000110010010100100100101010111010001010011100101010101010101000100010100110001010010100101010101101011011101000100110101010010010101010100011001001001010101100101011001101100010110010101000100110001011100000101101001010110010001010110010001010110010101110101011001101000010001000101011101101100011011000101010101010011010101100101011001011010010101110100010101001110011000010101011101010110010100100100010001010110011010110111000001010000010100100101010101001010010011000101010000110000011010000100011001000011011001110011110100111101";

			var numOfBytes = input.Length / 8;
			var bytes = new byte[numOfBytes];

			for (int i = 0; i < numOfBytes; ++i)
			{
				bytes[i] = Convert.ToByte(input.Substring(8 * i, 8), 2);
			}

			var inputString = System.Text.Encoding.ASCII.GetString(
				Convert.FromBase64String(
					System.Text.Encoding.ASCII.GetString(bytes)));

			Console.WriteLine(inputString);*/

			/*var inputString = "7958401743454e1756174552475256435e59501a5c524e176f786517545e475f5245191772195019175e4317445f58425b531743565c521756174443455e595017d5b7ab5f525b5b58174058455b53d5b7aa175659531b17505e41525917435f52175c524e175e4417d5b7ab5c524ed5b7aa1b174f584517435f5217515e454443175b524343524517d5b7ab5fd5b7aa17405e435f17d5b7ab5cd5b7aa1b17435f5259174f584517d5b7ab52d5b7aa17405e435f17d5b7ab52d5b7aa1b17435f525917d5b7ab5bd5b7aa17405e435f17d5b7ab4ed5b7aa1b1756595317435f5259174f58451759524f4317545f564517d5b7ab5bd5b7aa17405e435f17d5b7ab5cd5b7aa175650565e591b17435f525917d5b7ab58d5b7aa17405e435f17d5b7ab52d5b7aa1756595317445817585919176e5842175a564e17424452175659175e5953524f1758511754585e59545e53525954521b177f565a5a5e595017535e4443565954521b177c56445e445c5e17524f565a5e5956435e58591b17444356435e44435e54565b17435244434417584517405f564352415245175a52435f5853174e5842175152525b174058425b5317445f584017435f52175552444317455244425b4319";

			var inputStr = convertHexToAscii(inputString);

			//tryFindXorKey(inputStr);

			var key = 55;

			Console.WriteLine(decodeXorCeasar(key, inputStr));*/

			//Now try a repeating-key XOR cipher.
			//E.g. it should take a string "hello world" and, given the key is "key",
			//xor the first letter "h" with "k", then xor "e" with "e", then "l" with "y", and then xor next char "l" with 'k" again, then "o" with "e" and so on.
			//You may use an index of coincidence, Hamming distance, Kasiski examination, statistical tests or whatever method you feel would show the best result.

			/*var inputString = "G0IFOFVMLRAPI1QJbEQDbFEYOFEPJxAfI10JbEMFIUAAKRAfOVIfOFkYOUQFI15ML1kcJFUeYhA4IxAeKVQZL1VMOFgJbFMDIUAAKUgFOElMI1ZMOFgFPxADIlVMO1VMO1kAIBAZP1VMI14ANRAZPEAJPlMNP1VMIFUYOFUePxxMP19MOFgJbFsJNUMcLVMJbFkfbF8CIElMfgZNbGQDbFcJOBAYJFkfbF8CKRAeJVcEOBANOUQDIVEYJVMNIFwVbEkDORAbJVwAbEAeI1INLlwVbF4JKVRMOF9MOUMJbEMDIVVMP18eOBADKhALKV4JOFkPbFEAK18eJUQEIRBEO1gFL1hMO18eJ1UIbEQEKRAOKUMYbFwNP0RMNVUNPhlAbEMFIUUALUQJKBANIl4JLVwFIldMI0JMK0INKFkJIkRMKFUfL1UCOB5MH1UeJV8ZP1wVYBAbPlkYKRAFOBAeJVcEOBACI0dAbEkDORAbJVwAbF4JKVRMJURMOF9MKFUPJUAEKUJMOFgJbF4JNERMI14JbFEfbEcJIFxCbHIJLUJMJV5MIVkCKBxMOFgJPlVLPxACIxAfPFEPKUNCbDoEOEQcPwpDY1QDL0NCK18DK1wJYlMDIR8II1MZIVUCOB8IYwEkFQcoIB1ZJUQ1CAMvE1cHOVUuOkYuCkA4eHMJL3c8JWJffHIfDWIAGEA9Y1UIJURTOUMccUMELUIFIlc=";

			var inputStrringAscii = System.Text.Encoding.ASCII.GetString(
				Convert.FromBase64String(inputString));

			//TryFindVigenereKeyLength(inputStrringAscii);

			//TryFindVigenereXorKey(inputStrringAscii);

			//L0l - key

			Console.WriteLine(DecodeVigenereXorByKeys(76, 48, 108, inputStrringAscii));*/

			//Write a code to attack some simple substitution cipher.
			//To reduce the complexity of this one we will use only uppercase letters, so the keyspace is only 26!
			//To get this one right automatically you will probably need to use some sort of genetic algorithm
			//(which worked the best last year), simulated annealing or gradient descent.
			//Seriously, write it right now, you will need it to decipher the next one as well.Bear in mind, there's no spaces.
			//https://docs.google.com/document/d/1HY7Dl-5itYD3C_gkueBvvBFpT4CecGPiR30BsARlTpQ/edit?usp=shari

			var inputString = "EFFPQLEKVTVPCPYFLMVHQLUEWCNVWFYGHYTCETHQEKLPVMSAKSPVPAPVYWMVHQLUSPQLYWLASLFVWPQLMVHQLUPLRPSQLULQESPBLWPCSVRVWFLHLWFLWPUEWFYOTCMQYSLWOYWYETHQEKLPVMSAKSPVPAPVYWHEPPLUWSGYULEMQTLPPLUGUYOLWDTVSQETHQEKLPVPVSMTLEUPQEPCYAMEWWYTYWDLUULTCYWPQLSEOLSVOHTLUYAPVWLYGDALSSVWDPQLNLCKCLRQEASPVILSLEUMQBQVMQCYAHUYKEKTCASLFPYFLMVHQLUPQLHULIVYASHEUEDUEHQBVTTPQLVWFLRYGMYVWMVFLWMLSPVTTBYUNESESADDLSPVYWCYAMEWPUCPYFVIVFLPQLOLSSEDLVWHEUPSKCPQLWAOKLUYGMQEUEMPLUSVWENLCEWFEHHTCGULXALWMCEWETCSVSPYLEMQYGPQLOMEWCYAGVWFEBECPYASLQVDQLUYUFLUGULXALWMCSPEPVSPVMSBVPQPQVSPCHLYGMVHQLUPQLWLRPOEDVMETBYUFBVTTPENLPYPQLWLRPTEKLWZYCKVPTCSTESQPBYMEHVPETCMEHVPETZMEHVPETKTMEHVPETCMEHVPETT";

			var geneticKeySearcher = new GeneticKeySearcher(inputString, 1000);
			var key = geneticKeySearcher.GetKey();
			var bestValue = geneticKeySearcher.Decode(key);

			Console.WriteLine(bestValue);
		}

		#region Line 1

		private static void tryFindXorKey(string inputString)
		{
			for (int i = 100; i < 117; i++)
			{
				Console.WriteLine($"---------------------------------------{i}\n{decodeXorCeasar(i, inputString)}\n");
			}
		}

		private static string decodeXorCeasar(int key, string inputString)
		{
			var value = string.Empty;

			for (int j = 0; j < inputString.Length; j++)
			{
				value += Convert.ToChar(key ^ Convert.ToInt32(inputString[j]));
			}

			return value;
		}

		private static string convertHexToAscii(string inputString)
		{
			string ascii = string.Empty;

			for (int i = 0; i < inputString.Length; i += 2)
			{
				var hs = inputString.Substring(i, 2);
				ascii += Convert.ToChar(Convert.ToInt32(hs, 16));
			}

			return ascii;
		}

		#endregion

		#region Line 2

		public static void TryFindVigenereXorKey(string inputString)
		{
			for (int i = 0; i < 128; i++)
			{
				for (int j = 0; j < 128; j++)
				{
					for (int k = 0; k < 128; k++)
					{
						var key = string.Concat(Convert.ToChar(i), Convert.ToChar(j), Convert.ToChar(k)/*, Convert.ToChar(h)*/);

						var value = DecodeVigenereXorByKeys(i, j, k, inputString);
						if (getELetterFrequency(value) >= _eLetterFrequency &&
							getTLetterFrequency(value) >= _tLetterFrequency)
						{
							Console.WriteLine($"---------------------------------------{key}\n{value}");
						}
					}
				}
			}
		}

		public static string DecodeVigenereXorByKeys(int i, int j, int k, string inputString)
		{
			var value = string.Empty;
			for (int f = 0; f < inputString.Length - 2; f += 3)
			{
				value += Convert.ToChar(i ^ inputString[f]);
				value += Convert.ToChar(j ^ inputString[f + 1]);
				value += Convert.ToChar(k ^ inputString[f + 2]);
				//value += Convert.ToChar(h ^ inputString[f + 3]);
			}

			/*for (int h = 0; h < 128; h++)
			{

			}*/

			return value;
		}

		public static void TryFindVigenereKeyLength(string inputString)
		{
			var vigenereDict = new Dictionary<int, int>();

			for (int i = 1; i < 30; i++)
			{
				var newInputString = string.Concat(inputString.Substring(i), inputString.Substring(0, i));

				var counter = 0;

				for (int j = 0; j < inputString.Length; j++)
				{
					if (inputString[j] == newInputString[j])
					{
						counter++;
					}
				}

				vigenereDict.Add(i, counter);
			}

			foreach (var pair in vigenereDict.OrderBy(p => p.Value))
			{
				Console.WriteLine($"{pair.Key} - {pair.Value}");
			}
		}

		private static void tryDecodeByFrequencies(string inputString)//These are some bad tries to decode
		{
			var charactersEncryptionDict = new Dictionary<int, Dictionary<char, int>>();

			for (int i = 0; i < inputString.Length; i++)
			{
				var index = i % 4;
				if (!charactersEncryptionDict.TryGetValue(index, out var frequencyDict))
				{
					frequencyDict = new Dictionary<char, int>();
					charactersEncryptionDict.Add(index, frequencyDict);
				}

				var character = inputString[i];

				if (!frequencyDict.TryGetValue(character, out var frequency))
				{
					frequencyDict.Add(character, 1);
					continue;
				}

				frequencyDict[character] = frequency + 1;
			}

			var decodingDict = new Dictionary<int, Dictionary<char, char>>();

			foreach (var indexPair in charactersEncryptionDict)
			{
				//Console.WriteLine($"\n\n\n{indexPair.Key}\n\n\n");

				var decodingCharDict = new Dictionary<char, char>();
				decodingDict.Add(indexPair.Key, decodingCharDict);

				var counter = -1;

				foreach (var pair in indexPair.Value.OrderByDescending(p => p.Value))
				{
					counter++;
					if (counter > 2)
					{
						continue;
					}

					Console.WriteLine();
					switch (counter)
					{
						case 0:
							decodingCharDict.Add(pair.Key, 'e');
							continue;
						case 1:
							decodingCharDict.Add(pair.Key, 't');
							continue;
						case 2:
							decodingCharDict.Add(pair.Key, 'a');
							continue;
					}

					//Console.WriteLine($"{pair.Key} - {pair.Value}");
				}
			}

			var newString = string.Empty;
			for (int i = 0; i < inputString.Length; i++)
			{
				var index = i % 4;
				var decodingCharDict = decodingDict[index];

				var character = inputString[i];

				newString += decodingCharDict.TryGetValue(character, out var decodedChar)
					? decodedChar
					: character;
			}
		}

		private static decimal getLowercasePercent(string value)
		{
			return (decimal)value.Where(c => _lowercaseLetters.Contains(c)).Count() / value.Length;
		}

		private static decimal getELetterFrequency(string value)
		{
			return (decimal)value.Where(c => c == 'e' || c == 'E').Count() / value.Length;
		}

		private static decimal getTLetterFrequency(string value)
		{
			return (decimal)value.Where(c => c == 't' || c == 'T').Count() / value.Length;
		}

		#endregion

		#region Line 3

		private class GeneticKeySearcher
		{
			private static readonly List<char> _uppercaseLetters = new List<char> { 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z' };
			
			private static readonly HashSet<char> _consonantUppercaseLetters = new HashSet<char> { 'B', 'C', 'D', 'F', 'G', 'H', 'J', 'K', 'L', 'M', 'N', 'P', 'Q', 'R', 'S', 'T', 'V', 'W', 'X', 'Z' };

			private static readonly Dictionary<char, decimal> _letterFrequencies = new Dictionary<char, decimal>
			{
				{ 'A', (decimal)0.08167 },
				{ 'B', (decimal)0.01492 },
				{ 'C', (decimal)0.02782 },
				{ 'D', (decimal)0.04253 },
				{ 'E', (decimal)0.12702 },
				{ 'F', (decimal)0.02228 },
				{ 'G', (decimal)0.02015 },
				{ 'H', (decimal)0.06094 },
				{ 'I', (decimal)0.06966 },
				{ 'J', (decimal)0.00153 },
				{ 'K', (decimal)0.00772 },
				{ 'L', (decimal)0.04025 },
				{ 'M', (decimal)0.02406 },
				{ 'N', (decimal)0.06749 },
				{ 'O', (decimal)0.07507 },
				{ 'P', (decimal)0.01929 },
				{ 'Q', (decimal)0.00095 },
				{ 'R', (decimal)0.05987 },
				{ 'S', (decimal)0.06327 },
				{ 'T', (decimal)0.09056 },
				{ 'U', (decimal)0.02758 },
				{ 'V', (decimal)0.00978 },
				{ 'W', (decimal)0.02360 },
				{ 'X', (decimal)0.00150 },
				{ 'Y', (decimal)0.01974 },
				{ 'Z', (decimal)0.00074 }
			};

			private static readonly HashSet<string> _commonSyllablesAndWords = new HashSet<string>
			{
				"HE",
				"THE",
				"IN",
				"AND",
				"ALL",
				"ARE",
				"IS",
				"YOU",
				"DO",
				"ED",
				"IT",
				"TO",
				"TH",
				"ER",
				"AS",
				"AT",
				"AN",
				"RE",
				"ND",
				"OU",
				"EN",
				"ON",
				"HA",
				"OR",
				"ING",
				"HER",
				"VER",
				"WAS",
				"HAT",
				"FOR",
				"NOT",
				"THI",
				"THA",
				"HIS",
				"ENT",
				"ION",
				"ITH",
				"ERE",
				"WIT",
				"ALL",
				"EVE",
				"OUL",
				"ULD",
				"TIO",
				"TER",
				"HAD",
				"HEN",
				"ERA",
				"ARE",
				"HIN",
				"OUR",
				"SHO",
				"TED",
				"ALL",
				"AKE"
			};

			private string _cipher;

			private int _iterationsNumber;

			public GeneticKeySearcher(string cipher, int iterationsNumber)
			{
				_cipher = cipher;
				_iterationsNumber = iterationsNumber;
			}

			public Dictionary<char, char> GetKey()
			{
				var keys = new List<Dictionary<char, char>>();
				var key1 = new Dictionary<char, char>();
				var tIndex = -1;//I know there will be word "substitution", so I'll be a little sly
				for (int i = 0; i < _cipher.Length - 4; i++)
				{
					if (tIndex != -1)
					{
						continue;
					}

					var c1 = _cipher[i];
					var c2 = _cipher[i + 2];

					if (c1 != c2)
					{
						continue;
					}

					var c3 = _cipher[i + 4];

					if (c1 != c3)
					{
						continue;
					}

					tIndex = i;
					key1.Add(_cipher[i - 4], 'S');
					key1.Add(_cipher[i - 3], 'U');
					key1.Add(_cipher[i - 2], 'B');
					key1.Add(_cipher[i], 'T');
					key1.Add(_cipher[i + 1], 'I');
					key1.Add(_cipher[i + 6], 'O');
					key1.Add(_cipher[i + 7], 'N');
				}
				
				var key2 = new Dictionary<char, char>();

				var frequencyDict = _letterFrequencies.ToDictionary(p => p.Key, p => 0);

				for (int i = 0; i < _cipher.Length; i++)
				{
					var character = _cipher[i];

					frequencyDict[character] += 1;
				}

				var sortedFrequencyDict = frequencyDict.OrderBy(p => p.Value).ToList();
				var sortedLetterFrequencies = _letterFrequencies.OrderBy(p => p.Value).ToList();
				
				for (int i = 0; i < 26; i++)
				{
					key2.Add(sortedFrequencyDict[i].Key, sortedLetterFrequencies[i].Key);
				}

				if (tIndex == -1)
				{
					key1 = _uppercaseLetters.ToDictionary(c => c, c => Convert.ToChar(90 - _uppercaseLetters.IndexOf(c)));
				}
				else
				{
					sortedFrequencyDict.RemoveAll(p => key1.Keys.Contains(p.Key));
					sortedLetterFrequencies.RemoveAll(p => key1.Values.Contains(p.Key));
					for (int i = 0; i < 19; i++)
					{
						key1.Add(sortedFrequencyDict[i].Key, sortedLetterFrequencies[i].Key);
					}
				}

				keys.Add(key1);
				keys.Add(key2);

				keys.Add(_uppercaseLetters.ToDictionary(c => c, c => c));

				var key4 = new Dictionary<char, char>();
				var rand = new Random();

				foreach (var character in _uppercaseLetters)
				{
					var key = _uppercaseLetters.OrderBy(p => rand.Next()).First(c => !key4.ContainsKey(c));
					key4.Add(key, character);
				}

				keys.Add(key4);

				for (int i = 0; i < _iterationsNumber; i++)
				{
					var fitnessesToKeys = new Dictionary<Dictionary<char, char>, decimal>();

					var threeBestKeys = keys.OrderBy(k => getKeyFitness(k)).Take(3);
					keys = threeBestKeys.ToList();

					var newKey = mutate(keys[0], keys[2]);

					keys.Add(newKey);
				}

				return keys.OrderBy(k => getKeyFitness(k)).First();
			}


			public string Decode(Dictionary<char, char> key)
			{
				var value = string.Empty;

				foreach (var character in _cipher)
				{
					value += key[character];
				}

				return value;
			}

			private Dictionary<char, char> getBetterKey(Dictionary<char, char> key1, Dictionary<char, char> key2)
			{
				var fitness1 = getKeyFitness(key1);

				var fitness2 = getKeyFitness(key2);

				return fitness1 > fitness2
					? key2
					: key1;
			}

			private decimal getKeyFitness(Dictionary<char, char> key)
			{
				var value = Decode(key);

				var consonantParts = string.Empty;

				var part = string.Empty;
				var syllable = string.Empty;

				var points = 0;

				foreach (var character in value)
				{
					syllable += character;

					if (syllable.Length == 2)
					{
						if (_commonSyllablesAndWords.Contains(syllable))
						{
							points += 4;
						}
					}

					if (syllable.Length == 3)
					{
						if (_commonSyllablesAndWords.Contains(syllable))
						{
							points += 6;
						}

						syllable = syllable.Substring(1, 2);

						if (_commonSyllablesAndWords.Contains(syllable))
						{
							points += 4;
						}
					}

					if (_consonantUppercaseLetters.Contains(character))
					{
						part += character;
						continue;
					}

					if (part.Length > 3)
					{
						consonantParts += part;
					}

					part = string.Empty;
				}

				return (decimal)(consonantParts.Length - points) / 10 + key.Sum(p => Math.Abs(_letterFrequencies[p.Value] - getLetterFrequency(p.Value, value))) * 100;
			}

			private Dictionary<char, char> mutate(Dictionary<char, char> key1, Dictionary<char, char> key2)
			{
				var result = new Dictionary<char, char>();

				var value1 = Decode(key1);
				var value2 = Decode(key2);

				foreach (var pair in _letterFrequencies)
				{
					decimal points1 = 0;
					decimal points2 = 0;

					foreach (var syllable in _commonSyllablesAndWords.Where(s => s.Contains(pair.Key)))
					{
						if (value1.Contains(syllable))
						{
							points1 += syllable.Length;
						}
						if (value2.Contains(syllable))
						{
							points2 += syllable.Length;
						}
					}

					var key1PartFitness = points1 + Math.Abs(pair.Value - getLetterFrequency(pair.Key, value1));
					var key2PartFitness = points2 + Math.Abs(pair.Value - getLetterFrequency(pair.Key, value2));

					if (key1PartFitness > key2PartFitness)
					{
						addKeyPart(pair.Key, result, key2, key1);
					}
					else
					{
						addKeyPart(pair.Key, result, key1, key2);
					}
				}

				return result;
			}

			private void addKeyPart(char character, Dictionary<char, char> result, Dictionary<char, char> key1, Dictionary<char, char> key2)
			{
				var key = key1.First(p => p.Value == character).Key;

				if (!result.ContainsKey(key))
				{
					result.Add(key, character);
					return;
				}

				key = key2.First(p => p.Value == character).Key;

				if (!result.ContainsKey(key))
				{
					result.Add(key, character);
					return;
				}

				result.Add(_letterFrequencies.First(p => !result.ContainsKey(p.Key)).Key, character);
			}

			private decimal getLetterFrequency(char letter, string value)
			{
				return (decimal)value.Where(c => c == letter).Count() / value.Length;
			}
		}

		#endregion
	}
}
